{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport { perPage } from '../main';\nexport const getImagesByQuery = async (query, page) => {\n  const resp = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '51348790-b4b99e7923fa7dbd5fd948fd1',\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: perPage,\n    },\n  });\n  return resp.data;\n};\n","import { galleryEl, loaderEl, buttonEl } from '../main';\nimport SimpleLightbox from 'simplelightbox';\nexport const createMarkup = arr => {\n  return arr\n    .map(\n      ({\n        largeImageURL,\n        tags,\n        webformatURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t<img \n        \n\t\t  class=\"gallery-image\" \n\t\t  src=\"${webformatURL}\" \n\t\t  alt=\"${tags}\" \n\t\t/>\n\t</a>\n        <ul class = \"description\">\n        <li class = \"description-item\">Likes <p>${likes}</p><li>\n        <li class = \"description-item\">Views <p>${views}</p><li>\n        <li class = \"description-item\">Downloads <p>${downloads}</p><li>\n        <li class = \"description-item\">Comments <p>${comments}</p><li>\n        </ul>\n</li>`;\n      }\n    )\n    .join('');\n};\nexport const renderGallery = arr => {\n  galleryEl.insertAdjacentHTML('beforeend', createMarkup(arr));\n  createLightbox();\n};\nexport const clearMarkup = () => {\n  galleryEl.innerHTML = '';\n};\nconst gallery = new SimpleLightbox('.gallery a');\nfunction createLightbox() {\n  gallery.refresh();\n}\nexport const showLoader = () => {\n  loaderEl.classList.remove('visually-hidden');\n};\nexport const hideLoader = () => {\n  loaderEl.classList.add('visually-hidden');\n};\nexport const showLoadMoreButton = () => {\n  buttonEl.classList.remove('visually-hidden');\n};\nexport const hideLoadMoreButton = () => {\n  buttonEl.classList.add('visually-hidden');\n};\n","import { getImagesByQuery } from './js/pixabay-api';\nimport {\n  renderGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  clearMarkup,\n  hideLoadMoreButton,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\n//git\nlet currentPage = 1;\nexport let perPage = 15;\nlet totalPages = null;\nlet userQuery = null;\nlet cardHeight = null;\nconst formEl = document.querySelector('.form');\nexport const galleryEl = document.querySelector('.gallery');\nexport const loaderEl = document.querySelector('.loader');\nexport const buttonEl = document.querySelector('.js-show-more');\n\nconst onSubmit = async e => {\n  try {\n    e.preventDefault();\n\n    userQuery = formEl.elements['search-text'].value.trim();\n    if (!userQuery) {\n      return iziToast.error({\n        position: 'topRight',\n        title: 'Error',\n        message: `please fill your search request`,\n      });\n    }\n    showLoader();\n    clearMarkup();\n    hideLoadMoreButton();\n    buttonEl.removeEventListener('click', onShowMoreClick);\n    currentPage = 1;\n    const data = await getImagesByQuery(userQuery, currentPage);\n\n    totalPages = Math.ceil(data.totalHits / perPage);\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        position: 'topRight',\n        title: 'Error',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n      });\n    }\n\n    renderGallery(data.hits);\n\n    formEl.reset();\n\n    if (totalPages > 1) {\n      showLoadMoreButton();\n      buttonEl.addEventListener('click', onShowMoreClick);\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: `${error}`,\n    });\n  } finally {\n    hideLoader();\n  }\n};\nconst onShowMoreClick = async e => {\n  try {\n    showLoader();\n    currentPage++;\n    const { data } = await getImagesByQuery(userQuery, currentPage);\n    renderGallery(data.hits);\n    hideLoader();\n    scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n    if (currentPage === totalPages) {\n      hideLoadMoreButton();\n      buttonEl.removeEventListener('click', onShowMoreClick);\n      iziToast.error({\n        position: 'topRight',\n        title: 'Error',\n        message: `You have reached max pages, no more photos avialable`,\n      });\n    }\n    const heightCard =\n      galleryEl.lastElementChild.getBoundingClientRect().height;\n\n    scrollBy({\n      top: heightCard * 2 + 48,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\nformEl.addEventListener('submit', onSubmit);\n"],"names":["getImagesByQuery","query","page","axios","perPage","createMarkup","arr","largeImageURL","tags","webformatURL","likes","views","comments","downloads","renderGallery","galleryEl","createLightbox","clearMarkup","gallery","SimpleLightbox","showLoader","loaderEl","hideLoader","showLoadMoreButton","buttonEl","hideLoadMoreButton","currentPage","totalPages","userQuery","cardHeight","formEl","onSubmit","e","iziToast","onShowMoreClick","data","error","heightCard"],"mappings":"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"}